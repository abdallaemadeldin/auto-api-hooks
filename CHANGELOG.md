# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.1.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [1.1.0] - 2025-02-17

### Added

- **GraphQL subscription hooks** -- GraphQL `Subscription` type fields now generate WebSocket-based real-time hooks, grouped under a `subscriptions/` directory. Each fetcher strategy has an idiomatic implementation:
  - **SWR**: Uses `useSWRSubscription` from `swr/subscription` with native `next()` callback pattern
  - **React Query**: Custom hook with `useQueryClient` that auto-invalidates related queries on incoming data, tracks connection status (`connecting` / `connected` / `disconnected` / `error`)
  - **fetch / Axios**: Plain `useState`/`useEffect` with `WebSocket` API, returns `{ data, error, isConnected, unsubscribe }`
  - Subscriptions with arguments (e.g., `onMessage(channel: String!)`) accept a `variables` parameter
  - Supports `enabled` option to prevent auto-connect
- **`x-pagination` vendor extension** -- OpenAPI operations can now use `x-pagination` to explicitly specify pagination strategy, page parameter, next-page path, and items path. This overrides the heuristic auto-detection when it doesn't match your API's pagination pattern.
- **`--dry-run` CLI flag** -- Runs the full generation pipeline in memory and displays all files that would be generated, without writing anything to disk. Useful for previewing output or CI validation.
- **`--clean` CLI flag** -- Removes stale auto-generated files from the output directory that are no longer produced by the current generation. Only files with the `// Auto-generated by auto-api-hooks` header are candidates for removal; hand-written files are never touched.
- **`--prettier` CLI flag** -- Automatically formats all generated files using your project's Prettier configuration. Dynamically imports Prettier from your `node_modules`; silently skipped if Prettier is not installed.
- **`--silent` CLI flag** -- Suppresses all output except errors. Ideal for CI/CD pipelines where you only want to see failures.
- **Generation timestamp header** -- Every generated file now includes an `// Auto-generated by auto-api-hooks` comment with an ISO timestamp, making it easy to identify machine-generated files and when they were last updated.
- **`z.lazy()` for circular Zod schemas** -- The Zod emitter now automatically detects self-referencing and mutually recursive types and wraps them with `z.lazy()` to prevent runtime errors. Previously, circular type references could cause `ReferenceError` at module evaluation time.
- **Hook name collision detection** -- The generator now warns when two operations map to the same hook name (e.g. duplicate `operationId` values). Previously, the second hook would silently overwrite the first.

### Removed

- **`ts-morph` dependency** -- Removed unused `ts-morph` from production dependencies. This reduces install size and dependency count. The package uses string-based code generation and never needed `ts-morph`.

## [1.0.3] - 2025-02-17

### Changed

- SEO-optimized README with competitor comparisons, FAQ section, and search-friendly headings
- Added npm badges (version, downloads, bundle size, license, TypeScript)
- Added `repository`, `bugs`, `homepage`, and `author` fields to `package.json`
- Updated `description` in `package.json` for better npm search visibility
- Added GitHub repository, initialized git, and pushed to GitHub

## [1.0.2] - 2025-02-17

### Fixed

- Multi-file `$ref` resolution -- OpenAPI and Swagger specs with external `$ref` paths (e.g. `$ref: './paths/users.yaml'`) now resolve correctly. The parser passes the original file path to `SwaggerParser.dereference()` instead of a pre-parsed object.

### Changed

- Added `filePath` to `ParseOptions` interface for `$ref` path resolution
- Updated README to document multi-file spec support

## [1.0.0] - 2025-02-17

### Added

- Initial release
- OpenAPI 3.x, Swagger 2.0, and GraphQL schema parsing
- Four fetcher strategies: `fetch`, `axios`, `react-query` (TanStack v5), `swr`
- TypeScript type generation (params, body, response interfaces)
- Zod schema generation with format-aware refinements (`email`, `uuid`, `date-time`, `uri`)
- MSW v2 mock server generation (handlers, data factories, server/browser setup)
- Automatic pagination detection (cursor, offset-limit, page-number)
- Infinite query hook generation for `react-query` and `swr`
- React Query v5 cache key factories
- CLI with `generate` command and watch mode
- Programmatic API (`generate()`, `parseSpec()`, `generateHooks()`)
- Tag-based operation filtering
- One hook per file for maximum tree-shakeability
- GraphQL Relay connection pattern detection
